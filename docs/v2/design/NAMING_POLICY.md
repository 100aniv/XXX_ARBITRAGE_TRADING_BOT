# V2 ë„¤ì´ë° ì •ì±… (Naming Policy)

**ì‘ì„±ì¼:** 2025-12-29  
**ëª©ì :** V2 ê°œë°œì—ì„œ ì™¸ë¶€ ë…¸ì¶œ ì´ë¦„ê³¼ ë‚´ë¶€ ê²©ë¦¬ ì´ë¦„ì„ êµ¬ë¶„í•˜ì—¬ ê´€ë¦¬

---

## ğŸ“‹ í•µì‹¬ ì›ì¹™

**ì™¸ë¶€ ë…¸ì¶œ ì´ë¦„ (API/CLI/Metric/DB):** v2 ì ‘ë‘ ê¸ˆì§€  
**ë‚´ë¶€ ê²©ë¦¬ ì´ë¦„ (í´ë”/ëª¨ë“ˆ/ë„¤ì„ìŠ¤í˜ì´ìŠ¤):** v2 ì ‘ë‘ í—ˆìš©

---

## ğŸš« ê¸ˆì§€ ì‚¬í•­ (ì™¸ë¶€ ë…¸ì¶œ)

### 1. API ì—”ë“œí¬ì¸íŠ¸
- âŒ `/api/v2/orders` (v2 ê¸ˆì§€)
- âœ… `/api/orders` (ë²„ì „ ì—†ìŒ)
- âœ… `/api/v2.0/orders` (í•„ìš” ì‹œ semantic versioning)

**ì´ìœ :** API ë²„ì „ì€ HTTP Header (Accept: application/vnd.arbitrage+json;version=2) ë˜ëŠ” URL path parameterë¡œ ê´€ë¦¬

### 2. CLI ëª…ë ¹ì–´
- âŒ `arbitrage-v2 run` (v2 ê¸ˆì§€)
- âœ… `arbitrage run` (ë²„ì „ ì—†ìŒ)
- âœ… `arbitrage --version 2 run` (í•„ìš” ì‹œ flag)

**ì´ìœ :** CLIëŠ” ì‚¬ìš©ì ì§„ì…ì ì´ë¯€ë¡œ ë²„ì „ í‘œê¸° ìµœì†Œí™”

### 3. ë©”íŠ¸ë¦­ ì´ë¦„ (Prometheus)
- âŒ `arbitrage_v2_orders_total` (v2 ê¸ˆì§€)
- âœ… `arbitrage_orders_total` (ë²„ì „ ì—†ìŒ)
- âœ… `arbitrage_orders_total{version="2"}` (í•„ìš” ì‹œ label)

**ì´ìœ :** ë©”íŠ¸ë¦­ì€ ì‹œê³„ì—´ ë°ì´í„°ì´ë¯€ë¡œ ë²„ì „ì€ labelë¡œ ê´€ë¦¬

### 4. ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”/ìŠ¤í‚¤ë§ˆ
- âŒ `v2_orders` (v2 ê¸ˆì§€)
- âœ… `orders` (ë²„ì „ ì—†ìŒ)
- âœ… `orders_v2` (í•„ìš” ì‹œ suffix, ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ê°„ë§Œ)

**ì´ìœ :** DBëŠ” ì¥ê¸° ì €ì¥ì†Œì´ë¯€ë¡œ ë²„ì „ í‘œê¸° ìµœì†Œí™”, ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ê°„ë§Œ suffix í—ˆìš©

### 5. Redis í‚¤
- âŒ `v2:orders:*` (v2 ê¸ˆì§€)
- âœ… `orders:*` (ë²„ì „ ì—†ìŒ)
- âœ… `orders:v2:*` (í•„ìš” ì‹œ suffix, ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ê°„ë§Œ)

**ì´ìœ :** RedisëŠ” ì„ì‹œ ì €ì¥ì†Œì´ë¯€ë¡œ ë²„ì „ì€ key prefixë¡œ ê´€ë¦¬ ê°€ëŠ¥

### 6. í™˜ê²½ë³€ìˆ˜
- âŒ `ARBITRAGE_V2_API_KEY` (v2 ê¸ˆì§€)
- âœ… `ARBITRAGE_API_KEY` (ë²„ì „ ì—†ìŒ)
- âœ… `ARBITRAGE_API_KEY_V2` (í•„ìš” ì‹œ suffix)

**ì´ìœ :** í™˜ê²½ë³€ìˆ˜ëŠ” ë°°í¬ ì‹œì ì— ë²„ì „ì„ êµ¬ë¶„í•˜ë¯€ë¡œ ì´ë¦„ì— ë²„ì „ í‘œê¸° ë¶ˆí•„ìš”

---

## âœ… í—ˆìš© ì‚¬í•­ (ë‚´ë¶€ ê²©ë¦¬)

### 1. ì½”ë“œ í´ë”/ëª¨ë“ˆ
- âœ… `arbitrage/v2/` (v2 ë„¤ì„ìŠ¤í˜ì´ìŠ¤)
- âœ… `arbitrage/v2/core/engine.py`
- âœ… `arbitrage/v2/adapters/upbit_adapter.py`

**ì´ìœ :** ì½”ë“œëŠ” ë‚´ë¶€ êµ¬í˜„ì´ë¯€ë¡œ ë²„ì „ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ V1ê³¼ ê²©ë¦¬

### 2. ë¬¸ì„œ í´ë”
- âœ… `docs/v2/` (v2 ë¬¸ì„œ)
- âœ… `docs/v2/design/`
- âœ… `docs/v2/reports/`

**ì´ìœ :** ë¬¸ì„œëŠ” ê°œë°œ ê³¼ì • ê¸°ë¡ì´ë¯€ë¡œ ë²„ì „ í´ë”ë¡œ ê´€ë¦¬

### 3. í´ë˜ìŠ¤/í•¨ìˆ˜ ì´ë¦„ (ë‚´ë¶€ìš©)
- âœ… `V2Engine` (í´ë˜ìŠ¤)
- âœ… `v2_smoke_runner()` (í•¨ìˆ˜)
- âœ… `V2Config` (dataclass)

**ì´ìœ :** ë‚´ë¶€ êµ¬í˜„ì€ ë²„ì „ì„ ëª…ì‹œí•˜ì—¬ V1ê³¼ êµ¬ë¶„

### 4. í…ŒìŠ¤íŠ¸ íŒŒì¼
- âœ… `tests/test_v2_engine.py`
- âœ… `tests/test_v2_adapters.py`

**ì´ìœ :** í…ŒìŠ¤íŠ¸ëŠ” ê°œë°œ ê³¼ì •ì´ë¯€ë¡œ ë²„ì „ í‘œê¸° í—ˆìš©

### 5. ë¡œê·¸/ì¦ê±° ê²½ë¡œ
- âœ… `logs/evidence/d200_3_v2_smoke_20251229_111324/`
- âœ… `logs/v2_paper_run_20251229.log`

**ì´ìœ :** ë¡œê·¸ëŠ” ê°œë°œ ê³¼ì • ê¸°ë¡ì´ë¯€ë¡œ ë²„ì „ í‘œê¸° í—ˆìš©

---

## ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ê°„ ê·œì¹™ (V1 â†’ V2)

### Phase 1: ê³µì¡´ (í˜„ì¬)
- V1: `arbitrage/exchanges/`, `arbitrage/cross_exchange/`
- V2: `arbitrage/v2/`
- ì™¸ë¶€ ì¸í„°í˜ì´ìŠ¤: ë²„ì „ ì—†ìŒ (V1 ê¸°ë³¸)

### Phase 2: ì ì§„ì  ì „í™˜
- V1 â†’ V2 ì–´ëŒ‘í„° ì¶”ê°€ (ë‚´ë¶€ìš©)
- ì™¸ë¶€ ì¸í„°í˜ì´ìŠ¤: ì—¬ì „íˆ ë²„ì „ ì—†ìŒ
- í•„ìš” ì‹œ DB suffix ì‚¬ìš©: `orders_v2` (ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ê°„ë§Œ)

### Phase 3: V2 í”„ë¡œëª¨ì…˜
- V2ê°€ ê¸°ë³¸ êµ¬í˜„ìœ¼ë¡œ ì „í™˜
- ì™¸ë¶€ ì¸í„°í˜ì´ìŠ¤: ì—¬ì „íˆ ë²„ì „ ì—†ìŒ
- V1 ì½”ë“œ deprecated ë§ˆí‚¹

### Phase 4: V1 ì œê±°
- V1 ì½”ë“œ ì‚­ì œ
- ì™¸ë¶€ ì¸í„°í˜ì´ìŠ¤: ë²„ì „ ì—†ìŒ (ìœ ì§€)
- DB suffix ì œê±°: `orders` (ì •ê·œí™”)

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì‹ ê·œ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ)

- [ ] API ì—”ë“œí¬ì¸íŠ¸: v2 ì ‘ë‘ ì—†ìŒ
- [ ] CLI ëª…ë ¹ì–´: v2 ì ‘ë‘ ì—†ìŒ
- [ ] ë©”íŠ¸ë¦­ ì´ë¦„: v2 ì ‘ë‘ ì—†ìŒ (label ì‚¬ìš©)
- [ ] DB í…Œì´ë¸”: v2 ì ‘ë‘ ì—†ìŒ (suffix í•„ìš” ì‹œë§Œ)
- [ ] Redis í‚¤: v2 ì ‘ë‘ ì—†ìŒ (suffix í•„ìš” ì‹œë§Œ)
- [ ] í™˜ê²½ë³€ìˆ˜: v2 ì ‘ë‘ ì—†ìŒ (suffix í•„ìš” ì‹œë§Œ)
- [ ] ì½”ë“œ í´ë”: `arbitrage/v2/` ì‚¬ìš©
- [ ] í´ë˜ìŠ¤/í•¨ìˆ˜: V2 prefix ì‚¬ìš© (ë‚´ë¶€ìš©)
- [ ] ë¬¸ì„œ í´ë”: `docs/v2/` ì‚¬ìš©
- [ ] í…ŒìŠ¤íŠ¸ íŒŒì¼: `test_v2_*` ì‚¬ìš©

---

## ğŸ¯ ì˜ˆì‹œ

### âŒ ì˜ëª»ëœ ì˜ˆ
```python
# API
@app.get("/api/v2/orders")  # v2 ê¸ˆì§€

# CLI
def arbitrage_v2_run():  # v2 ê¸ˆì§€

# Metric
arbitrage_v2_orders_total = Counter(...)  # v2 ê¸ˆì§€

# DB
CREATE TABLE v2_orders (...)  # v2 ê¸ˆì§€

# Redis
redis.set("v2:orders:123", ...)  # v2 ê¸ˆì§€
```

### âœ… ì˜¬ë°”ë¥¸ ì˜ˆ
```python
# API
@app.get("/api/orders")  # ë²„ì „ ì—†ìŒ

# CLI
def arbitrage_run():  # ë²„ì „ ì—†ìŒ

# Metric
arbitrage_orders_total = Counter(..., labels=["version"])  # label ì‚¬ìš©

# DB
CREATE TABLE orders (...)  # ë²„ì „ ì—†ìŒ

# Redis
redis.set("orders:123", ...)  # ë²„ì „ ì—†ìŒ

# ë‚´ë¶€ ì½”ë“œ
class V2Engine:  # V2 prefix í—ˆìš©
    pass

# ë‚´ë¶€ í´ë”
arbitrage/v2/core/engine.py  # v2 í´ë” í—ˆìš©
```

---

## ğŸ“š ì°¸ê³ 

- SSOT_MAP: `docs/v2/design/SSOT_MAP.md`
- SSOT_RULES: `docs/v2/SSOT_RULES.md`
- V2_ARCHITECTURE: `docs/v2/V2_ARCHITECTURE.md`

---

**ì´ ì •ì±…ì€ V2 ê°œë°œ ì „ë°˜ì— ê±¸ì³ ê°•ì œ ì ìš©ë˜ë©°, ìœ„ë°˜ ì‹œ ì½”ë“œ ë¦¬ë·°ì—ì„œ ì§€ì ë©ë‹ˆë‹¤.**
