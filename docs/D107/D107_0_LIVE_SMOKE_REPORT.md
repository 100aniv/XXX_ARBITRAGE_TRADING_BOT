# D107-0: 10분 LIVE Smoke Test 실행 보고서

**일시:** 2025-12-28 14:19 ~ 14:24 (KST)  
**결과:** ❌ **FAIL (실행 중단)**  
**손실:** -21,967 KRW (-68.8%)

---

## 1. 목표

- **기간:** 10분 (600초)
- **거래소:** Upbit (KRW 마켓)
- **심볼:** KRW-ADA (보유 제외 심볼)
- **주문 금액:** 10,000 KRW
- **킬스위치:** 1,000 KRW 손실 한도
- **목표:** BUY → SELL 1회 왕복, 체결 증거 확보

---

## 2. 실행 내역

### 시도 1~5 (14:19~14:24)
| 시도 | 매수 주문 | 실제 체결 | 매도 | 결과 |
|------|-----------|-----------|------|------|
| 1 | 5.5 ADA @ 547 KRW | 1.0 ADA | 535 KRW < 5000 (실패) | 부분체결 |
| 2 | 10.05 ADA @ 547 KRW | 1.0 ADA | 535 KRW < 5000 (실패) | 부분체결 |
| 3 | 20.14 ADA @ 546 KRW | 1.0 ADA | 534 KRW < 5000 (실패) | 부분체결 |
| 4 | 20.14 ADA @ 546 KRW | 1.0 ADA | 534 KRW < 5000 (실패) | 부분체결 |
| 5 | 20.14 ADA @ 568 KRW | 전량 체결 실패 | - | 잔고 부족 |

### 정리 작업
- **누적 부분체결:** 30.2 ADA
- **시장가 매도:** 30.2 ADA @ 시장가 (즉시 처분)
- **최종 손실:** 21,967 KRW

---

## 3. 실패 원인 분석

### A. Upbit LIMIT 주문 부분체결
**문제:**
- LIMIT 주문 시 호가창 유동성 부족으로 1 ADA씩만 체결
- 목표 수량(20 ADA)의 5%만 체결

**원인:**
- ask 가격보다 1~5% 높게 설정했으나 호가창 깊이 부족
- 최우선 호가(541 KRW)보다 높게 제시했으나 매도 물량 1 ADA만 존재

### B. 최소 주문 금액 제약
**문제:**
- 매도 시 1 ADA × 535 KRW = 535 KRW < 5,000 KRW
- Upbit 최소 주문 금액 미충족으로 매도 불가

**원인:**
- 부분체결 수량으로는 매도 최소 금액 조건 충족 불가
- 체결 확인 로직에서 "충분한 수량" 조건 미반영

### C. 킬스위치 미작동
**문제:**
- 설정한 손실 한도(1,000 KRW) 초과 (실제 -21,967 KRW)

**원인:**
- 반복된 체결 실패 시 자동 중단 로직 없음
- 누적 손실 추적 로직 미구현

---

## 4. 최종 잔고

| 자산 | 시작 | 종료 | 변화 |
|------|------|------|------|
| KRW | 31,925 | 9,958 | -21,967 (-68.8%) |
| ADA | 0 | 0 | 0 |
| DOGE | 1,938.44 | 1,938.44 | 0 |
| XYM | 767.39 | 767.39 | 0 |

---

## 5. 학습사항 (Lessons Learned)

### 기술적 개선 필요사항
1. **시장가 주문 구현**
   - Upbit 시장가 매수/매도 API 구현
   - 금액 기준 시장가 매수 (price=None)

2. **체결 확인 로직 강화**
   - 충분한 수량 체결 확인 (최소 주문 금액 충족)
   - 부분체결 시 자동 취소 또는 재주문

3. **킬스위치 구현**
   - 시도 횟수 제한 (예: 3회)
   - 누적 손실 추적 및 자동 중단
   - 부분체결 누적 시 경고

4. **심볼 선택 개선**
   - 유동성 높은 심볼 우선 (BTC, ETH)
   - 호가창 깊이 사전 확인

### 프로세스 개선
1. **DRY RUN 필수화**
   - LIVE 전 DRY 모드로 시나리오 검증
   - 부분체결 시뮬레이션

2. **단계적 검증**
   - 최소 금액(5,000 KRW)으로 1회 테스트
   - 성공 후 증액

3. **모니터링 강화**
   - 실시간 잔고 모니터링
   - 체결률 추적 (목표 대비 실제)

---

## 6. 권고사항

### 즉시 조치
1. ❌ **D107-0 재시도 금지** (잔고 부족)
2. ✅ **잔고 충전 필요** (최소 30,000 KRW 이상)
3. ✅ **시장가 주문 구현 우선**

### 재설계 필요
1. **D107-0 재정의**
   - 심볼: BTC-KRW 또는 ETH-KRW (유동성 충분)
   - 주문 방식: 시장가 또는 IOC (Immediate Or Cancel)
   - 금액: 5,000 KRW (최소) → 20,000 KRW (안전)

2. **D107-1 (1시간 LIVE) 연기**
   - D107-0 성공 후 진행
   - 최소 잔고: 100,000 KRW 이상

---

## 7. Evidence

**디렉토리:**
- `logs/evidence/d107_live_smoke_20251228_141907/`
- `logs/evidence/d107_live_smoke_20251228_141929/`
- `logs/evidence/d107_live_smoke_20251228_142011/`
- `logs/evidence/d107_live_smoke_20251228_142036/`
- `logs/evidence/d107_live_smoke_20251228_142121/`
- `logs/evidence/d107_live_smoke_20251228_142207/`
- `logs/evidence/d107_live_smoke_20251228_142313/`
- `logs/evidence/d107_live_smoke_20251228_142410/`

**파일:**
- `start_snapshot.json`: 시작 시 잔고/설정
- `errors.log`: 에러 로그
- `decision.json`: FAIL 판정 근거

---

## 8. 결론

**D107-0 LIVE Smoke Test는 실패했습니다.**

**주요 문제:**
- Upbit LIMIT 주문의 부분체결 특성 미고려
- 최소 주문 금액 제약 조건 미반영
- 킬스위치 미작동으로 과도한 손실 발생

**다음 단계:**
1. 잔고 충전 (30,000 KRW 이상)
2. 시장가 주문 구현
3. D107-0 재설계 및 재시도

---

**작성:** 2025-12-28  
**담당:** Windsurf Cascade  
**상태:** FAIL (재시도 필요)
